{"ast":null,"code":"import _classCallCheck from\"C:\\\\xampp\\\\htdocs\\\\vexedientu\\\\Front-End\\\\dath-react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\xampp\\\\htdocs\\\\vexedientu\\\\Front-End\\\\dath-react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\xampp\\\\htdocs\\\\vexedientu\\\\Front-End\\\\dath-react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\xampp\\\\htdocs\\\\vexedientu\\\\Front-End\\\\dath-react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component,version}from\"react\";import{connect}from\"react-redux\";import{Redirect}from\"react-router-dom\";import Axios from\"axios\";import{Formik,Form,Field,ErrorMessage}from\"formik\";import swal from\"sweetalert\";var DanhSachVe=/*#__PURE__*/function(_Component){_inherits(DanhSachVe,_Component);var _super=_createSuper(DanhSachVe);function DanhSachVe(props){var _this;_classCallCheck(this,DanhSachVe);_this=_super.call(this,props);_this.idKhachHang=localStorage.getItem(\"idKH\");_this._handleSubmit=function(values){values.idVe=_this.state.id;values.TieuDe=_this.state.TenLC;values.Gia=_this.state.Gia;var postData=values;var axiosConfig={headers:{\"Content-Type\":\"application/json;charset=UTF-8\",\"Access-Control-Allow-Origin\":\"*\"}};Axios.post(\"/api/news\",postData,axiosConfig).then(function(res){swal({title:\"Tuyệt vời!\",text:\"Bạn đã đăng vé thành công!\",icon:\"success\"});console.log(res);}).catch(function(err){console.log(err);});console.log(values);};_this.state={id:\"\",tenLC:\"\",gia:\"\"};return _this;}_createClass(DanhSachVe,[{key:\"getDataAPI\",value:function getDataAPI(){var _this2=this;Axios.all([Axios.get(\"http://localhost:8000/api/login\"),Axios.get(\"http://localhost:8000/api/khachhang\"),Axios.get(\"http://localhost:8000/api/ve\"),Axios.get(\"http://localhost:8000/api/lichchay\"),Axios.get(\"http://localhost:8000/api/TicketUser/\"+this.idKhachHang)]).then(function(resArr){// đẩy dữ liệu danh sách lịch chạy từ API get được vào reducer\n_this2.props.dispatch({type:\"FETCH_DSKHACHHANG\",payload:resArr[0].data});_this2.props.dispatch({type:\"FETCH_KHACHHANG\",payload:resArr[1].data});_this2.props.dispatch({type:\"FETCH_DSVE\",payload:resArr[2].data});_this2.props.dispatch({type:\"FETCH_DSLICHCHAY\",payload:resArr[3].data});_this2.props.dispatch({type:\"FETCH_TICKETUSER\",payload:resArr[4].data});// console.log(this.idKhachHang);\nconsole.log(_this2.props.ticketUserData);}).catch(function(err){console.log(err);});}},{key:\"getTTVeBan\",value:function getTTVeBan(x,y,z){return this.setState({id:x.toString(),TenLC:y,Gia:z});}},{key:\"update\",value:function update(x){var employee={idVe:this.state.id};var axiosConfig={headers:{\"Content-Type\":\"application/json;charset=UTF-8\",\"Access-Control-Allow-Origin\":\"*\"}};Axios.put(\"http://localhost:8000/api/tradeticket/\"+x,employee,axiosConfig).then(function(res){return console.log(res.data);});}},{key:\"delete\",value:function _delete(x){var axiosConfig={headers:{\"Content-Type\":\"application/json;charset=UTF-8\",\"Access-Control-Allow-Origin\":\"*\"}};Axios.delete(\"http://localhost:8000/api/news/\"+x,axiosConfig).then(function(res){return console.log(res.data);});}},{key:\"componentDidMount\",value:function componentDidMount(){this.getDataAPI();}},{key:\"renderDSVE\",value:function renderDSVE(){var _this$props$ticketUse,_this3=this;return(_this$props$ticketUse=this.props.ticketUserData)===null||_this$props$ticketUse===void 0?void 0:_this$props$ticketUse.map(function(ticket,index){return/*#__PURE__*/React.createElement(\"tr\",{key:index},/*#__PURE__*/React.createElement(\"td\",null,ticket.id),/*#__PURE__*/React.createElement(\"td\",null,ticket.NgayDatVe),/*#__PURE__*/React.createElement(\"td\",null,ticket.TenLC),/*#__PURE__*/React.createElement(\"td\",null,ticket.NgayKhoiHanh),/*#__PURE__*/React.createElement(\"td\",null,ticket.GioKhoiHanh),/*#__PURE__*/React.createElement(\"td\",null,ticket.TrangThai==0?/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-success\",\"data-toggle\":\"modal\",\"data-target\":\"#modelId\",onClick:function onClick(){return _this3.getTTVeBan(ticket.id,ticket.TenLC,ticket.Gia);}},\"\\u0110\\u0103ng v\\xE9\"):ticket.TrangThai==1?/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-warning\",\"data-toggle\":\"modal\",\"data-target\":\"#modelId\",onClick:function onClick(){return _this3.getTTVeBan(ticket.id,ticket.TenLC,ticket.Gia);},disabled:true},\"\\u0110ang trao \\u0111\\u1ED5i\"),\" \",/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-danger\",onClick:function onClick(){return _this3.delete(ticket.id);}},\"H\\u1EE7y\")):/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-primary\",onClick:function onClick(){return _this3.update(ticket.id);}},\"X\\xE1c nh\\u1EADn\")),/*#__PURE__*/React.createElement(\"div\",{className:\"modal fade\",id:\"modelId\",tabIndex:-1,role:\"dialog\",\"aria-labelledby\":\"modelTitleId\",\"aria-hidden\":\"true\"},/*#__PURE__*/React.createElement(\"div\",{className:\"modal-dialog\",role:\"document\"},/*#__PURE__*/React.createElement(\"div\",{className:\"modal-content\"},/*#__PURE__*/React.createElement(\"div\",{className:\"modal-header\"},/*#__PURE__*/React.createElement(\"h5\",{className:\"modal-title\"},\"Th\\xF4ng tin v\\xE9\"),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"close\",\"data-dismiss\":\"modal\",\"aria-label\":\"Close\"},/*#__PURE__*/React.createElement(\"span\",{\"aria-hidden\":\"true\"},\"\\xD7\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"modal-body\"},/*#__PURE__*/React.createElement(Formik,{initialValues:{idVe:_this3.state.id,TieuDe:_this3.state.TenLC,Gia:_this3.state.Gia},onSubmit:_this3._handleSubmit,render:function render(formikProps){return/*#__PURE__*/React.createElement(Form,{className:\"bg-white rounded p-4 text-left\",action:true,method:true},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{htmlfor:\"exampleFormControlSelect2\"},\"Ch\\u1ECDn v\\xE9*\"),/*#__PURE__*/React.createElement(Field,{type:\"text\",name:\"idVe\",value:_this3.state.id,className:\"form-control\",id:\"idVeBan\",disabled:true,onChange:formikProps.handleChange})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{htmlfor:\"exampleFormControlInput1\"},\"Ti\\xEAu \\u0111\\u1EC1*\"),/*#__PURE__*/React.createElement(Field,{type:\"text\",name:\"TieuDe\",value:_this3.state.TenLC,className:\"form-control\",id:\"exampleFormControlInput1\",disabled:true,onChange:formikProps.handleChange})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{htmlfor:\"exampleFormControlInput1\"},\"Gi\\xE1*\"),/*#__PURE__*/React.createElement(Field,{type:\"text\",name:\"Gia\",className:\"form-control\",id:\"exampleFormControlInput1\",value:_this3.state.Gia,disabled:true,onChange:formikProps.handleChange})),/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-success\"},\"\\u0110\\u0103ng tin\"));}})),/*#__PURE__*/React.createElement(\"div\",{className:\"modal-footer\"},/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"btn btn-secondary\",\"data-dismiss\":\"modal\"},\"\\u0110\\xF3ng\"),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"btn btn-primary\"},\"L\\u01B0u\"))))));});}},{key:\"render\",value:function render(){if(this.props.loginStatus===false){return/*#__PURE__*/React.createElement(Redirect,{to:\"/dang-nhap\"});}return/*#__PURE__*/React.createElement(\"div\",{className:\"container\",style:{marginTop:\"100px\"}},/*#__PURE__*/React.createElement(\"h3\",null,\"Danh s\\xE1ch v\\xE9\"),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"table\",{class:\"table\"},/*#__PURE__*/React.createElement(\"thead\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"th\",null,\"ID\"),/*#__PURE__*/React.createElement(\"th\",null,\"Ng\\xE0y \\u0111\\u1EB7t v\\xE9\"),/*#__PURE__*/React.createElement(\"th\",null,\"Tuy\\u1EBFn\"),/*#__PURE__*/React.createElement(\"th\",null,\"Ng\\xE0y kh\\u1EDFi h\\xE0nh\"),/*#__PURE__*/React.createElement(\"th\",null,\"Gi\\u1EDD kh\\u1EDFi h\\xE0nh\"),/*#__PURE__*/React.createElement(\"th\",null,\"Tr\\u1EA1ng th\\xE1i\"))),/*#__PURE__*/React.createElement(\"tbody\",null,this.renderDSVE()))));}}]);return DanhSachVe;}(Component);var mapStateToProps=function mapStateToProps(state,ownProps){return{loginStatus:state.loginReducer,khachhangData:state.khachhangReducer.khachhangData,dsVeData:state.dsVeReducer.dsVeData,dsLichChayData:state.dslichchayReducer.dslichchayData,ticketUserData:state.ticketUserReducer.ticketUserData};};export default connect(mapStateToProps)(DanhSachVe);","map":{"version":3,"sources":["C:/xampp/htdocs/vexedientu/Front-End/dath-react/src/components/DanhSachVe.js"],"names":["React","Component","version","connect","Redirect","Axios","Formik","Form","Field","ErrorMessage","swal","DanhSachVe","props","idKhachHang","localStorage","getItem","_handleSubmit","values","idVe","state","id","TieuDe","TenLC","Gia","postData","axiosConfig","headers","post","then","res","title","text","icon","console","log","catch","err","tenLC","gia","all","get","resArr","dispatch","type","payload","data","ticketUserData","x","y","z","setState","toString","employee","put","delete","getDataAPI","map","ticket","index","NgayDatVe","NgayKhoiHanh","GioKhoiHanh","TrangThai","getTTVeBan","update","formikProps","handleChange","loginStatus","marginTop","renderDSVE","mapStateToProps","ownProps","loginReducer","khachhangData","khachhangReducer","dsVeData","dsVeReducer","dsLichChayData","dslichchayReducer","dslichchayData","ticketUserReducer"],"mappings":"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","sourcesContent":["import React, { Component, version } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport Axios from \"axios\";\r\nimport { Formik, Form, Field, ErrorMessage } from \"formik\";\r\nimport swal from \"sweetalert\";\r\n\r\nclass DanhSachVe extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      id: \"\",\r\n      tenLC: \"\",\r\n      gia: \"\",\r\n    };\r\n  }\r\n  idKhachHang = localStorage.getItem(\"idKH\");\r\n\r\n  getDataAPI() {\r\n    Axios.all([\r\n      Axios.get(\"http://localhost:8000/api/login\"),\r\n      Axios.get(\"http://localhost:8000/api/khachhang\"),\r\n      Axios.get(\"http://localhost:8000/api/ve\"),\r\n      Axios.get(\"http://localhost:8000/api/lichchay\"),\r\n      Axios.get(\"http://localhost:8000/api/TicketUser/\" + this.idKhachHang),\r\n    ])\r\n      .then((resArr) => {\r\n        // đẩy dữ liệu danh sách lịch chạy từ API get được vào reducer\r\n        this.props.dispatch({\r\n          type: \"FETCH_DSKHACHHANG\",\r\n          payload: resArr[0].data,\r\n        });\r\n        this.props.dispatch({\r\n          type: \"FETCH_KHACHHANG\",\r\n          payload: resArr[1].data,\r\n        });\r\n        this.props.dispatch({\r\n          type: \"FETCH_DSVE\",\r\n          payload: resArr[2].data,\r\n        });\r\n        this.props.dispatch({\r\n          type: \"FETCH_DSLICHCHAY\",\r\n          payload: resArr[3].data,\r\n        });\r\n        this.props.dispatch({\r\n          type: \"FETCH_TICKETUSER\",\r\n          payload: resArr[4].data,\r\n        });\r\n        // console.log(this.idKhachHang);\r\n        console.log(this.props.ticketUserData);\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n      });\r\n  }\r\n  getTTVeBan(x, y, z) {\r\n    return this.setState({ id: x.toString(), TenLC: y, Gia: z });\r\n  }\r\n\r\n  _handleSubmit = (values) => {\r\n    values.idVe = this.state.id;\r\n    values.TieuDe = this.state.TenLC;\r\n    values.Gia = this.state.Gia;\r\n    var postData = values;\r\n\r\n    let axiosConfig = {\r\n      headers: {\r\n        \"Content-Type\": \"application/json;charset=UTF-8\",\r\n        \"Access-Control-Allow-Origin\": \"*\",\r\n      },\r\n    };\r\n\r\n    Axios.post(\"/api/news\", postData, axiosConfig)\r\n      .then((res) => {\r\n        swal({\r\n          title: \"Tuyệt vời!\",\r\n          text: \"Bạn đã đăng vé thành công!\",\r\n          icon: \"success\",\r\n        });\r\n        console.log(res);\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n      });\r\n    console.log(values);\r\n  };\r\n  update(x) {\r\n    const employee = {\r\n      idVe: this.state.id,\r\n    };\r\n    let axiosConfig = {\r\n      headers: {\r\n        \"Content-Type\": \"application/json;charset=UTF-8\",\r\n        \"Access-Control-Allow-Origin\": \"*\",\r\n      },\r\n    };\r\n    Axios.put(\r\n      \"http://localhost:8000/api/tradeticket/\" + x,employee,\r\n      axiosConfig\r\n    ).then((res) => console.log(res.data));\r\n  }\r\n  delete(x) {\r\n    let axiosConfig = {\r\n      headers: {\r\n        \"Content-Type\": \"application/json;charset=UTF-8\",\r\n        \"Access-Control-Allow-Origin\": \"*\",\r\n      },\r\n    };\r\n    Axios.delete(\"http://localhost:8000/api/news/\" + x, axiosConfig).then((res) =>\r\n      console.log(res.data)\r\n    );\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getDataAPI();\r\n  }\r\n  renderDSVE() {\r\n    return this.props.ticketUserData?.map((ticket, index) => {\r\n      return (\r\n        <tr key={index}>\r\n          <td>{ticket.id}</td>\r\n          <td>{ticket.NgayDatVe}</td>\r\n          <td>{ticket.TenLC}</td>\r\n          <td>{ticket.NgayKhoiHanh}</td>\r\n          <td>{ticket.GioKhoiHanh}</td>\r\n          <td>\r\n            {ticket.TrangThai == 0 ? (\r\n              <button\r\n                className=\"btn btn-success\"\r\n                data-toggle=\"modal\"\r\n                data-target=\"#modelId\"\r\n                onClick={() =>\r\n                  this.getTTVeBan(ticket.id, ticket.TenLC, ticket.Gia)\r\n                }\r\n              >\r\n                Đăng vé\r\n              </button>\r\n            ) : ticket.TrangThai == 1 ? (\r\n              <div>\r\n                <button\r\n                  className=\"btn btn-warning\"\r\n                  data-toggle=\"modal\"\r\n                  data-target=\"#modelId\"\r\n                  onClick={() =>\r\n                    this.getTTVeBan(ticket.id, ticket.TenLC, ticket.Gia)\r\n                  }\r\n                  disabled\r\n                >\r\n                  Đang trao đổi\r\n                </button>{\" \"}\r\n                <button\r\n                  className=\"btn btn-danger\"\r\n                  onClick={()=>this.delete(ticket.id)}\r\n                >\r\n                  Hủy\r\n                </button>\r\n              </div>\r\n            ) : (\r\n              <button\r\n                className=\"btn btn-primary\"\r\n                onClick={() =>\r\n                  this.update(ticket.id)\r\n                }\r\n              >\r\n                Xác nhận\r\n              </button>\r\n            )}\r\n          </td>\r\n          <div\r\n            className=\"modal fade\"\r\n            id=\"modelId\"\r\n            tabIndex={-1}\r\n            role=\"dialog\"\r\n            aria-labelledby=\"modelTitleId\"\r\n            aria-hidden=\"true\"\r\n          >\r\n            <div className=\"modal-dialog\" role=\"document\">\r\n              <div className=\"modal-content\">\r\n                <div className=\"modal-header\">\r\n                  <h5 className=\"modal-title\">Thông tin vé</h5>\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"close\"\r\n                    data-dismiss=\"modal\"\r\n                    aria-label=\"Close\"\r\n                  >\r\n                    <span aria-hidden=\"true\">×</span>\r\n                  </button>\r\n                </div>\r\n                <div className=\"modal-body\">\r\n                  <Formik\r\n                    initialValues={{\r\n                      idVe: this.state.id,\r\n                      TieuDe: this.state.TenLC,\r\n                      Gia: this.state.Gia,\r\n                    }}\r\n                    onSubmit={this._handleSubmit}\r\n                    render={(formikProps) => (\r\n                      <Form\r\n                        className=\"bg-white rounded p-4 text-left\"\r\n                        action\r\n                        method\r\n                      >\r\n                        <div className=\"form-group\">\r\n                          <label htmlfor=\"exampleFormControlSelect2\">\r\n                            Chọn vé*\r\n                          </label>\r\n                          <Field\r\n                            type=\"text\"\r\n                            name=\"idVe\"\r\n                            value={this.state.id}\r\n                            className=\"form-control\"\r\n                            id=\"idVeBan\"\r\n                            disabled\r\n                            onChange={formikProps.handleChange}\r\n                          />\r\n                        </div>\r\n                        <div className=\"form-group\">\r\n                          <label htmlfor=\"exampleFormControlInput1\">\r\n                            Tiêu đề*\r\n                          </label>\r\n                          <Field\r\n                            type=\"text\"\r\n                            name=\"TieuDe\"\r\n                            value={this.state.TenLC}\r\n                            className=\"form-control\"\r\n                            id=\"exampleFormControlInput1\"\r\n                            disabled\r\n                            onChange={formikProps.handleChange}\r\n                          />\r\n                        </div>\r\n                        <div className=\"form-group\">\r\n                          <label htmlfor=\"exampleFormControlInput1\">Giá*</label>\r\n                          <Field\r\n                            type=\"text\"\r\n                            name=\"Gia\"\r\n                            className=\"form-control\"\r\n                            id=\"exampleFormControlInput1\"\r\n                            value={this.state.Gia}\r\n                            disabled\r\n                            onChange={formikProps.handleChange}\r\n                          />\r\n                        </div>\r\n                        <button className=\"btn btn-success\">Đăng tin</button>\r\n                      </Form>\r\n                    )}\r\n                  />\r\n                </div>\r\n                <div className=\"modal-footer\">\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"btn btn-secondary\"\r\n                    data-dismiss=\"modal\"\r\n                  >\r\n                    Đóng\r\n                  </button>\r\n                  <button type=\"button\" className=\"btn btn-primary\">\r\n                    Lưu\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </tr>\r\n      );\r\n    });\r\n  }\r\n\r\n  render() {\r\n    if (this.props.loginStatus === false) {\r\n      return <Redirect to=\"/dang-nhap\" />;\r\n    }\r\n    return (\r\n      <div className=\"container\" style={{ marginTop: \"100px\" }}>\r\n        <h3>Danh sách vé</h3>\r\n        <div className=\"row\">\r\n          <table class=\"table\">\r\n            <thead>\r\n              <tr>\r\n                <th>ID</th>\r\n                <th>Ngày đặt vé</th>\r\n                <th>Tuyến</th>\r\n                <th>Ngày khởi hành</th>\r\n                <th>Giờ khởi hành</th>\r\n                <th>Trạng thái</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>{this.renderDSVE()}</tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\nconst mapStateToProps = (state, ownProps) => {\r\n  return {\r\n    loginStatus: state.loginReducer,\r\n    khachhangData: state.khachhangReducer.khachhangData,\r\n    dsVeData: state.dsVeReducer.dsVeData,\r\n    dsLichChayData: state.dslichchayReducer.dslichchayData,\r\n    ticketUserData: state.ticketUserReducer.ticketUserData,\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps)(DanhSachVe);\r\n"]},"metadata":{},"sourceType":"module"}