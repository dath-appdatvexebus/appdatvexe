{"ast":null,"code":"import _classCallCheck from\"C:\\\\xampp\\\\htdocs\\\\vexedientu\\\\Front-End\\\\dath-react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\xampp\\\\htdocs\\\\vexedientu\\\\Front-End\\\\dath-react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _assertThisInitialized from\"C:\\\\xampp\\\\htdocs\\\\vexedientu\\\\Front-End\\\\dath-react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:\\\\xampp\\\\htdocs\\\\vexedientu\\\\Front-End\\\\dath-react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\xampp\\\\htdocs\\\\vexedientu\\\\Front-End\\\\dath-react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import ReactNotification from\"react-notifications-component\";import\"react-notifications-component/dist/theme.css\";import{store}from\"react-notifications-component\";import Axios from\"axios\";import{connect}from\"react-redux\";import{Redirect}from\"react-router-dom\";var ChonGhe=/*#__PURE__*/function(_Component){_inherits(ChonGhe,_Component);var _super=_createSuper(ChonGhe);function ChonGhe(props){var _this;_classCallCheck(this,ChonGhe);_this=_super.call(this,props);_this.state={seat:[],seatAvailable:[],seatReserved:[],seatBooked:[],isGoThongTinDatVe:false};_this.handleSubmit=_this.handleSubmit.bind(_assertThisInitialized(_this));return _this;}_createClass(ChonGhe,[{key:\"handleSubmit\",value:function handleSubmit(e){var _this2=this;e.preventDefault();if(this.state.seatReserved.length===0){store.addNotification({message:\"Vui lòng chọn ghế bạn muốn\",type:\"warning\",insert:\"top\",container:\"top-right\",animationIn:[\"animated\",\"animate__flipInX\"],animationOut:[\"animated\",\"animate__fadeOutDown\"],dismiss:{duration:5000,onScreen:true}});}else{this.props.dslichchayData.map(function(item){if(item.idTuyen===_this2.step1.idTuyen){return _this2.tongtien=parseInt(item.Gia)*parseInt(_this2.state.seatReserved.length);}});this.setState({isGoThongTinDatVe:true,tongtien:this.tongtien},function(){if(typeof Storage!==\"undefined\"){// Khởi tạo sesionStorage\nsessionStorage.setItem(\"chonghe\",JSON.stringify(_this2.state));}else{alert(\"Trình duyệt của bạn không hỗ trợ!\");}return console.log(_this2.state);});}}// xử lý sự kiện onclich chọn ghế\n},{key:\"onClickData\",value:function onClickData(seat){if(this.state.seatBooked.indexOf(seat)>-1){store.addNotification({message:\"Ghế này đã có người đặt trước, vui lòng chọn ghế khác\",type:\"warning\",insert:\"top\",container:\"top-right\",animationIn:[\"animated\",\"animate__flipInX\"],animationOut:[\"animated\",\"animate__fadeOutDown\"],dismiss:{duration:5000,onScreen:true}});}else if(this.state.seatReserved.indexOf(seat)>-1){this.setState({seatAvailable:this.state.seatAvailable.concat(seat),seatReserved:this.state.seatReserved.filter(function(res){return res!==seat;})});store.addNotification({message:\"Bạn đã bỏ chọn ghế \"+seat,type:\"info\",insert:\"top\",container:\"top-right\",animationIn:[\"animated\",\"animate__flipInX\"],animationOut:[\"animated\",\"animate__fadeOutDown\"],dismiss:{duration:5000,onScreen:true}});}else{this.setState({seatReserved:this.state.seatReserved.concat(seat),seatAvailable:this.state.seatAvailable.filter(function(res){return res!==seat;})});store.addNotification({message:\"Bạn vừa chọn ghế \"+seat,type:\"success\",insert:\"top\",container:\"top-right\",animationIn:[\"animated\",\"animate__flipInX\"],animationOut:[\"animated\",\"animate__fadeOutDown\"],dismiss:{duration:5000,onScreen:true}});}}},{key:\"UNSAFE_componentWillMount\",value:function UNSAFE_componentWillMount(){if(typeof Storage!==\"undefined\"){// get sessionStorage\nthis.step1=JSON.parse(sessionStorage.getItem(\"chonTuyen\"));}else{alert(\"Vui lòng quay lại trang chủ\");}}//get data từ API\n},{key:\"getDataAPI\",value:function getDataAPI(){var _this3=this;Axios.all([Axios.get(\"http://localhost:8000/api/lichchay\"),Axios.get(\"http://localhost:8000/api/xe\")]).then(function(resArr){// đẩy dữ liệu danh sách lịch chạy từ API get được vào reducer\n_this3.props.dispatch({type:\"FETCH_DSLICHCHAY\",payload:resArr[0].data});// đẩy dữ liệu danh sách xe từ API get được vào reducer\n_this3.props.dispatch({type:\"FETCH_DSXE\",payload:resArr[1].data});// lấy id xe, lấy id lịch chạy\n_this3.props.dslichchayData.map(function(item){if(item.idTuyen===_this3.step1.idTuyen){_this3.setState({idXe:item.idXe,idLichChay:item.id},function(){console.log(_this3.state);});}});// lấy danh sách ghế từ xe ra\n_this3.props.dsxeData.map(function(item){if(item.id===_this3.state.idXe){// đẩy tất cả ghế vào dạng chuỗi\nvar tatcaghe=item.TatCaGhe.split(/[\\s,]+/);// đẩy các ghế đã đặt vào dạng chuỗi\nvar ghedadat=item.GheDaDat.split(/[\\s,]+/);// lọc ra ghế còn trống\nvar ghetrong=tatcaghe.filter(function(i){return!ghedadat.includes(i);});// đẩy tất cả ghế vào ma trận sợ đồ để in ra\nvar toMatrix=function toMatrix(arr,width){return arr.reduce(function(rows,key,index){return(index%width===0?rows.push([key]):rows[rows.length-1].push(key))&&rows;},[]);};var matranghe=toMatrix(tatcaghe,4);_this3.setState({seatBooked:ghedadat,seatAvailable:ghetrong,seat:matranghe});}});}).catch(function(err){console.log(err);});}},{key:\"componentDidMount\",value:function componentDidMount(){this.getDataAPI();}},{key:\"render\",value:function render(){var _this4=this;// định dạng ngày đi ra màn hình\nvar ngaydi=this.step1.ngayDi;var tempdate=\"\";var inngaydi=tempdate.concat(ngaydi.substr(8,2),\" \",ngaydi.substr(4,1),\" \",ngaydi.substr(5,2),\" \",ngaydi.substr(4,1),\" \",ngaydi.substr(0,4));//điều kiện chuyển hướng\nif(this.state.isGoThongTinDatVe===true){return/*#__PURE__*/React.createElement(Redirect,{to:\"/thong-tin-dat-ve\"});}return/*#__PURE__*/React.createElement(\"section\",{id:\"chonghe\"},/*#__PURE__*/React.createElement(ReactNotification,null),/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"md-stepper-horizontal\"},/*#__PURE__*/React.createElement(\"div\",{className:\"md-step active\"},/*#__PURE__*/React.createElement(\"div\",{className:\"md-step-circle\"},/*#__PURE__*/React.createElement(\"span\",{className:\"material-icons\"},\"directions_bus\")),/*#__PURE__*/React.createElement(\"div\",{className:\"md-step-title\"},\"Ch\\u1ECDn tuy\\u1EBFn\"),/*#__PURE__*/React.createElement(\"div\",{className:\"md-step-bar-left\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"md-step-bar-right\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"md-step active\"},/*#__PURE__*/React.createElement(\"div\",{className:\"md-step-circle\"},/*#__PURE__*/React.createElement(\"span\",{className:\"material-icons\"},\"event_seat\")),/*#__PURE__*/React.createElement(\"div\",{className:\"md-step-title\"},\"Ch\\u1ECDn gh\\u1EBF\"),/*#__PURE__*/React.createElement(\"div\",{className:\"md-step-bar-left\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"md-step-bar-right\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"md-step\"},/*#__PURE__*/React.createElement(\"div\",{className:\"md-step-circle\"},/*#__PURE__*/React.createElement(\"span\",{className:\"material-icons\"},\"edit\")),/*#__PURE__*/React.createElement(\"div\",{className:\"md-step-title\"},\"\\u0110i\\u1EC1n th\\xF4ng tin\"),/*#__PURE__*/React.createElement(\"div\",{className:\"md-step-bar-left\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"md-step-bar-right\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"md-step\"},/*#__PURE__*/React.createElement(\"div\",{className:\"md-step-circle\"},/*#__PURE__*/React.createElement(\"span\",{className:\"material-icons\"},\"credit_card\")),/*#__PURE__*/React.createElement(\"div\",{className:\"md-step-title\"},\"Thanh to\\xE1n\"),/*#__PURE__*/React.createElement(\"div\",{className:\"md-step-bar-left\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"md-step-bar-right\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-8\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card-header card-header-primary\"},/*#__PURE__*/React.createElement(\"h4\",{className:\"card-title\"},\"M\\u1EDDi b\\u1EA1n ch\\u1ECDn gh\\u1EBF\")),/*#__PURE__*/React.createElement(\"div\",{className:\"table-responsive|table-responsive-sm|table-responsive-md|table-responsive-lg|table-responsive-xl\"},/*#__PURE__*/React.createElement(\"h5\",{id:\"text-confirm\",style:{fontWeight:300,marginTop:\"24px\"}},\"B\\u1EA1n \\u0111\\xE3 ch\\u1ECDn\",/*#__PURE__*/React.createElement(\"span\",{style:{color:\"red\",fontWeight:\"bold\",paddingLeft:\"3px\",paddingRight:\"3px\"}},\"(\",this.state.seatReserved.length,\")\"),\"gh\\u1EBF\",/*#__PURE__*/React.createElement(\"br\",null),this.state.seatReserved.map(function(item){return item+\", \";})),/*#__PURE__*/React.createElement(\"h5\",{id:\"tongTien\",style:{fontWeight:300}},\"T\\u1ED5ng s\\u1ED1 ti\\u1EC1n l\\xE0:\",/*#__PURE__*/React.createElement(\"span\",{style:{color:\"red\",fontWeight:\"bold\"}},\"(\",this.props.dslichchayData.map(function(item,index){if(item.idTuyen===_this4.step1.idTuyen){return(parseInt(item.Gia)*parseInt(_this4.state.seatReserved.length)).toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g,\",\");}}),\")\"),\"\\u0111\")),/*#__PURE__*/React.createElement(DrawGrid,{seat:this.state.seat,available:this.state.seatAvailable,reserved:this.state.seatReserved,booked:this.state.seatBooked,onClickData:this.onClickData.bind(this)}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card-header card-header-primary\"},/*#__PURE__*/React.createElement(\"h4\",{className:\"card-title\"},this.step1.inputTuyen,\" \",/*#__PURE__*/React.createElement(\"br\",null),inngaydi)),/*#__PURE__*/React.createElement(\"div\",{className:\"card-body\"},/*#__PURE__*/React.createElement(\"form\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"form-check form-check-radio\"},/*#__PURE__*/React.createElement(\"label\",{className:\"form-check-label\"},/*#__PURE__*/React.createElement(\"input\",{className:\"form-check-input\",type:\"radio\",name:\"exampleRadios\",id:\"exampleRadios2\",defaultValue:\"option2\",defaultChecked:true}),\"Gi\\xE1 v\\xE9:\",\" \",this.props.dslichchayData.map(function(item,index){if(item.idTuyen===_this4.step1.idTuyen){return item.Gia.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g,\",\");}}),\" \",\"\\u0111 / ng\\u01B0\\u1EDDi\",/*#__PURE__*/React.createElement(\"span\",{className:\"circle\"},/*#__PURE__*/React.createElement(\"span\",{className:\"check\"})))),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"h4\",{className:\"info-title\",style:{marginBottom:\"0px\"}},\"Bi\\u1EC3n s\\u1ED1 xe\"),/*#__PURE__*/React.createElement(\"p\",null,this.props.dsxeData.map(function(item){if(item.id===_this4.state.idXe){return item.BSXe;}}))),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"h4\",{className:\"info-title\",style:{marginBottom:\"0px\"}},\"Gi\\u1EDD kh\\u1EDFi h\\xE0nh\"),/*#__PURE__*/React.createElement(\"select\",{className:\"form-control\",id:\"exampleFormControlSelect1\",name:\"GioKhoiHanh\"},/*#__PURE__*/React.createElement(\"option\",{value:\"06:00\"},\"06:00\"),/*#__PURE__*/React.createElement(\"option\",{value:\"09:00\"},\"09:00\"),/*#__PURE__*/React.createElement(\"option\",{value:\"12:00\"},\"12:00\"),/*#__PURE__*/React.createElement(\"option\",{value:\"18:00\"},\"18:00\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"h4\",{className:\"info-title\",style:{marginBottom:\"0px\"}},\"\\u0110i\\u1EC3m l\\xEAn xe\"),/*#__PURE__*/React.createElement(\"select\",{className:\"form-control\",id:\"exampleFormControlSelect2\"},/*#__PURE__*/React.createElement(\"option\",null,\"475A \\u0110i\\u1EC7n Bi\\xEAn Ph\\u1EE7\"),/*#__PURE__*/React.createElement(\"option\",null,\"Khu C\\xF4ng Ngh\\u1EC7 Cao\"),/*#__PURE__*/React.createElement(\"option\",null,\"Ung V\\u0103n Khi\\xEAm\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"info pt-1\"},/*#__PURE__*/React.createElement(\"h4\",{className:\"info-title\"},\"Mi\\u1EC5n ph\\xED\"),/*#__PURE__*/React.createElement(\"div\",{className:\"icon icon-info\"},/*#__PURE__*/React.createElement(\"div\",{className:\"icon icon-primary\"},/*#__PURE__*/React.createElement(\"i\",{className:\"material-icons\"},\"wifi\"),/*#__PURE__*/React.createElement(\"i\",{className:\"material-icons\"},\"fastfood\"),/*#__PURE__*/React.createElement(\"i\",{className:\"material-icons\"},\"music_video\")))),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"btn btn-block btn-success\",onClick:function onClick(e){return _this4.handleSubmit(e);}},\"Ti\\u1EBFp t\\u1EE5c \",/*#__PURE__*/React.createElement(\"span\",{className:\"material-icons\"},\"forward\")))))))));}}]);return ChonGhe;}(Component);var DrawGrid=/*#__PURE__*/function(_React$Component){_inherits(DrawGrid,_React$Component);var _super2=_createSuper(DrawGrid);function DrawGrid(){_classCallCheck(this,DrawGrid);return _super2.apply(this,arguments);}_createClass(DrawGrid,[{key:\"render\",value:function render(){var _this5=this;var classOfSeat=function classOfSeat(col){if(_this5.props.reserved.indexOf(col)>-1){return\"reserved\";}else if(_this5.props.booked.indexOf(col)>-1){return\"booked\";}else{return\"available\";}};return/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"table\",{className:\"table table-striped|table-dark|table-bordered|table-borderless|table-hover|table-sm\"},/*#__PURE__*/React.createElement(\"thead\",{className:\"thead-dark|thead-light\",style:{padding:\"16px 16px\"}},/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"th\",{scope:\"col\",style:{color:\"#ff9e00\"}},\"S\\u01A1 \\u0111\\u1ED3 gh\\u1EBF\"),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\"},/*#__PURE__*/React.createElement(\"div\",{style:{color:\"#eaeaea\"}},/*#__PURE__*/React.createElement(\"span\",{className:\"material-icons\"},\"airline_seat_recline_extra\"),/*#__PURE__*/React.createElement(\"br\",null),\" \\u0111\\xE3 \\u0111\\u1EB7t\")),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\"},/*#__PURE__*/React.createElement(\"div\",{style:{color:\"#ff9e00\"}},/*#__PURE__*/React.createElement(\"span\",{className:\"material-icons\"},\"airline_seat_recline_extra\"),/*#__PURE__*/React.createElement(\"br\",null),\" \\u0111ang ch\\u1ECDn\")),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\"},/*#__PURE__*/React.createElement(\"div\",{style:{color:\"#202429\"}},/*#__PURE__*/React.createElement(\"span\",{className:\"material-icons\"},\"airline_seat_recline_extra\"),/*#__PURE__*/React.createElement(\"br\",null),\" c\\xF2n tr\\u1ED1ng\")))),/*#__PURE__*/React.createElement(\"tbody\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"img\",{style:{width:\"50px\",height:\"50px\"},src:\"assets/img/volang.png\",alt:\"T\\xE0i x\\u1EBF\"}),\" \",/*#__PURE__*/React.createElement(\"h4\",{className:\"card-title\"},\"L\\xE1i xe\")),/*#__PURE__*/React.createElement(\"td\",null),/*#__PURE__*/React.createElement(\"td\",null),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"img\",{style:{width:\"50px\",height:\"50px\"},src:\"assets/img/cua.png\",alt:\"C\\u1EEDa l\\xEAn xu\\u1ED1ng\"}),/*#__PURE__*/React.createElement(\"h4\",{className:\"card-title\"},\"C\\u1EEDa l\\xEAn\"))),this.props.seat.map(function(row){return/*#__PURE__*/React.createElement(\"tr\",{key:row},row.map(function(col){return/*#__PURE__*/React.createElement(\"td\",{className:classOfSeat(col),key:col,onClick:function onClick(e){return _this5.onClickSeat(col);}},/*#__PURE__*/React.createElement(\"span\",{className:\"material-icons\"},\"airline_seat_recline_extra\"),/*#__PURE__*/React.createElement(\"br\",null),col,\" \");}));}))));}},{key:\"onClickSeat\",value:function onClickSeat(seat){this.props.onClickData(seat);}}]);return DrawGrid;}(React.Component);// class AvailableList extends React.Component {\n//   render() {\n//     const seatCount = this.props.available.length;\n//     return (\n//       <div className=\"text-center\">\n//         <h4>\n//           Ghế còn trống: ({seatCount === 0 ? \"No seats available\" : seatCount})\n//         </h4>\n//         <span>\n//           {this.props.available.map((res) => (\n//             <p key={res}>{res} - </p>\n//           ))}\n//         </span>\n//       </div>\n//     );\n//   }\n// }\n// class ReservedList extends React.Component {\n//   render() {\n//     return (\n//       <div className=\"right\">\n//         <h4>Ghế đang chọn: ({this.props.reserved.length})</h4>\n//         <ul>\n//           {this.props.reserved.map((res) => (\n//             <li key={res}>{res}</li>\n//           ))}\n//         </ul>\n//       </div>\n//     );\n//   }\n// }\nvar mapStateToProps=function mapStateToProps(state,ownProps){return{dslichchayData:state.dslichchayReducer.dslichchayData,dsxeData:state.dsxeReducer.dsxeData};};export default connect(mapStateToProps)(ChonGhe);","map":{"version":3,"sources":["C:/xampp/htdocs/vexedientu/Front-End/dath-react/src/components/ChonGhe.js"],"names":["React","Component","ReactNotification","store","Axios","connect","Redirect","ChonGhe","props","state","seat","seatAvailable","seatReserved","seatBooked","isGoThongTinDatVe","handleSubmit","bind","e","preventDefault","length","addNotification","message","type","insert","container","animationIn","animationOut","dismiss","duration","onScreen","dslichchayData","map","item","idTuyen","step1","tongtien","parseInt","Gia","setState","Storage","sessionStorage","setItem","JSON","stringify","alert","console","log","indexOf","concat","filter","res","parse","getItem","all","get","then","resArr","dispatch","payload","data","idXe","idLichChay","id","dsxeData","tatcaghe","TatCaGhe","split","ghedadat","GheDaDat","ghetrong","i","includes","toMatrix","arr","width","reduce","rows","key","index","push","matranghe","catch","err","getDataAPI","ngaydi","ngayDi","tempdate","inngaydi","substr","fontWeight","marginTop","color","paddingLeft","paddingRight","toString","replace","onClickData","inputTuyen","marginBottom","BSXe","DrawGrid","classOfSeat","col","reserved","booked","padding","height","row","onClickSeat","mapStateToProps","ownProps","dslichchayReducer","dsxeReducer"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport ReactNotification from \"react-notifications-component\";\r\nimport \"react-notifications-component/dist/theme.css\";\r\nimport { store } from \"react-notifications-component\";\r\nimport Axios from \"axios\";\r\nimport { connect } from \"react-redux\";\r\nimport { Redirect } from \"react-router-dom\";\r\n\r\nclass ChonGhe extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      seat: [],\r\n      seatAvailable: [],\r\n      seatReserved: [],\r\n      seatBooked: [],\r\n      isGoThongTinDatVe: false,\r\n    };\r\n    this.handleSubmit = this.handleSubmit.bind(this);\r\n  }\r\n\r\n  handleSubmit(e) {\r\n    e.preventDefault();\r\n    if (this.state.seatReserved.length === 0) {\r\n      store.addNotification({\r\n        message: \"Vui lòng chọn ghế bạn muốn\",\r\n        type: \"warning\",\r\n        insert: \"top\",\r\n        container: \"top-right\",\r\n        animationIn: [\"animated\", \"animate__flipInX\"],\r\n        animationOut: [\"animated\", \"animate__fadeOutDown\"],\r\n        dismiss: {\r\n          duration: 5000,\r\n          onScreen: true,\r\n        },\r\n      });\r\n    } else {\r\n      this.props.dslichchayData.map((item) => {\r\n        if (item.idTuyen === this.step1.idTuyen) {\r\n          return (this.tongtien =\r\n            parseInt(item.Gia) * parseInt(this.state.seatReserved.length));\r\n        }\r\n      });\r\n      this.setState(\r\n        { isGoThongTinDatVe: true, tongtien: this.tongtien },\r\n        () => {\r\n          if (typeof Storage !== \"undefined\") {\r\n            // Khởi tạo sesionStorage\r\n            sessionStorage.setItem(\"chonghe\", JSON.stringify(this.state));\r\n          } else {\r\n            alert(\"Trình duyệt của bạn không hỗ trợ!\");\r\n          }\r\n          return console.log(this.state);\r\n        }\r\n      );\r\n    }\r\n  }\r\n\r\n  // xử lý sự kiện onclich chọn ghế\r\n  onClickData(seat) {\r\n    if (this.state.seatBooked.indexOf(seat) > -1) {\r\n      store.addNotification({\r\n        message: \"Ghế này đã có người đặt trước, vui lòng chọn ghế khác\",\r\n        type: \"warning\",\r\n        insert: \"top\",\r\n        container: \"top-right\",\r\n        animationIn: [\"animated\", \"animate__flipInX\"],\r\n        animationOut: [\"animated\", \"animate__fadeOutDown\"],\r\n        dismiss: {\r\n          duration: 5000,\r\n          onScreen: true,\r\n        },\r\n      });\r\n    } else if (this.state.seatReserved.indexOf(seat) > -1) {\r\n      this.setState({\r\n        seatAvailable: this.state.seatAvailable.concat(seat),\r\n        seatReserved: this.state.seatReserved.filter((res) => res !== seat),\r\n      });\r\n      store.addNotification({\r\n        message: \"Bạn đã bỏ chọn ghế \" + seat,\r\n        type: \"info\",\r\n        insert: \"top\",\r\n        container: \"top-right\",\r\n        animationIn: [\"animated\", \"animate__flipInX\"],\r\n        animationOut: [\"animated\", \"animate__fadeOutDown\"],\r\n        dismiss: {\r\n          duration: 5000,\r\n          onScreen: true,\r\n        },\r\n      });\r\n    } else {\r\n      this.setState({\r\n        seatReserved: this.state.seatReserved.concat(seat),\r\n        seatAvailable: this.state.seatAvailable.filter((res) => res !== seat),\r\n      });\r\n      store.addNotification({\r\n        message: \"Bạn vừa chọn ghế \" + seat,\r\n        type: \"success\",\r\n        insert: \"top\",\r\n        container: \"top-right\",\r\n        animationIn: [\"animated\", \"animate__flipInX\"],\r\n        animationOut: [\"animated\", \"animate__fadeOutDown\"],\r\n        dismiss: {\r\n          duration: 5000,\r\n          onScreen: true,\r\n        },\r\n      });\r\n    }\r\n  }\r\n  step1; // biến chứa dữ liệu từ session storage\r\n\r\n  tongtien;\r\n\r\n  UNSAFE_componentWillMount() {\r\n    if (typeof Storage !== \"undefined\") {\r\n      // get sessionStorage\r\n      this.step1 = JSON.parse(sessionStorage.getItem(\"chonTuyen\"));\r\n    } else {\r\n      alert(\"Vui lòng quay lại trang chủ\");\r\n    }\r\n  }\r\n\r\n  //get data từ API\r\n  getDataAPI() {\r\n    Axios.all([\r\n      Axios.get(\"http://localhost:8000/api/lichchay\"),\r\n      Axios.get(\"http://localhost:8000/api/xe\"),\r\n    ])\r\n      .then((resArr) => {\r\n        // đẩy dữ liệu danh sách lịch chạy từ API get được vào reducer\r\n        this.props.dispatch({\r\n          type: \"FETCH_DSLICHCHAY\",\r\n          payload: resArr[0].data,\r\n        });\r\n        // đẩy dữ liệu danh sách xe từ API get được vào reducer\r\n        this.props.dispatch({\r\n          type: \"FETCH_DSXE\",\r\n          payload: resArr[1].data,\r\n        });\r\n\r\n        // lấy id xe, lấy id lịch chạy\r\n        this.props.dslichchayData.map((item) => {\r\n          if (item.idTuyen === this.step1.idTuyen) {\r\n            this.setState({ idXe: item.idXe, idLichChay: item.id }, () => {\r\n              console.log(this.state);\r\n            });\r\n          }\r\n        });\r\n\r\n        // lấy danh sách ghế từ xe ra\r\n        this.props.dsxeData.map((item) => {\r\n          if (item.id === this.state.idXe) {\r\n            // đẩy tất cả ghế vào dạng chuỗi\r\n            var tatcaghe = item.TatCaGhe.split(/[\\s,]+/);\r\n            // đẩy các ghế đã đặt vào dạng chuỗi\r\n            var ghedadat = item.GheDaDat.split(/[\\s,]+/);\r\n            // lọc ra ghế còn trống\r\n            const ghetrong = tatcaghe.filter((i) => !ghedadat.includes(i));\r\n\r\n            // đẩy tất cả ghế vào ma trận sợ đồ để in ra\r\n            const toMatrix = (arr, width) =>\r\n              arr.reduce(\r\n                (rows, key, index) =>\r\n                  (index % width === 0\r\n                    ? rows.push([key])\r\n                    : rows[rows.length - 1].push(key)) && rows,\r\n                []\r\n              );\r\n            var matranghe = toMatrix(tatcaghe, 4);\r\n\r\n            this.setState({\r\n              seatBooked: ghedadat,\r\n              seatAvailable: ghetrong,\r\n              seat: matranghe,\r\n            });\r\n          }\r\n        });\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n      });\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getDataAPI();\r\n  }\r\n\r\n  render() {\r\n    // định dạng ngày đi ra màn hình\r\n    var ngaydi = this.step1.ngayDi;\r\n    var tempdate = \"\";\r\n    var inngaydi = tempdate.concat(\r\n      ngaydi.substr(8, 2),\r\n      \" \",\r\n      ngaydi.substr(4, 1),\r\n      \" \",\r\n      ngaydi.substr(5, 2),\r\n      \" \",\r\n      ngaydi.substr(4, 1),\r\n      \" \",\r\n      ngaydi.substr(0, 4)\r\n    );\r\n\r\n    //điều kiện chuyển hướng\r\n    if (this.state.isGoThongTinDatVe === true) {\r\n      return <Redirect to=\"/thong-tin-dat-ve\" />;\r\n    }\r\n    return (\r\n      <section id=\"chonghe\">\r\n        <ReactNotification />\r\n        <div className=\"container\">\r\n          <div className=\"md-stepper-horizontal\">\r\n            <div className=\"md-step active\">\r\n              <div className=\"md-step-circle\">\r\n                <span className=\"material-icons\">directions_bus</span>\r\n              </div>\r\n              <div className=\"md-step-title\">Chọn tuyến</div>\r\n              <div className=\"md-step-bar-left\" />\r\n              <div className=\"md-step-bar-right\" />\r\n            </div>\r\n            <div className=\"md-step active\">\r\n              <div className=\"md-step-circle\">\r\n                <span className=\"material-icons\">event_seat</span>\r\n              </div>\r\n              <div className=\"md-step-title\">Chọn ghế</div>\r\n              <div className=\"md-step-bar-left\" />\r\n              <div className=\"md-step-bar-right\" />\r\n            </div>\r\n            <div className=\"md-step\">\r\n              <div className=\"md-step-circle\">\r\n                <span className=\"material-icons\">edit</span>\r\n              </div>\r\n              <div className=\"md-step-title\">Điền thông tin</div>\r\n              <div className=\"md-step-bar-left\" />\r\n              <div className=\"md-step-bar-right\" />\r\n            </div>\r\n            <div className=\"md-step\">\r\n              <div className=\"md-step-circle\">\r\n                <span className=\"material-icons\">credit_card</span>\r\n              </div>\r\n              <div className=\"md-step-title\">Thanh toán</div>\r\n              <div className=\"md-step-bar-left\" />\r\n              <div className=\"md-step-bar-right\" />\r\n            </div>\r\n          </div>\r\n          <div className=\"row\">\r\n            <div className=\"col-md-8\">\r\n              <div className=\"card\">\r\n                <div className=\"card-header card-header-primary\">\r\n                  <h4 className=\"card-title\">Mời bạn chọn ghế</h4>\r\n                </div>\r\n                <div className=\"table-responsive|table-responsive-sm|table-responsive-md|table-responsive-lg|table-responsive-xl\">\r\n                  <h5\r\n                    id=\"text-confirm\"\r\n                    style={{ fontWeight: 300, marginTop: \"24px\" }}\r\n                  >\r\n                    Bạn đã chọn\r\n                    <span\r\n                      style={{\r\n                        color: \"red\",\r\n                        fontWeight: \"bold\",\r\n                        paddingLeft: \"3px\",\r\n                        paddingRight: \"3px\",\r\n                      }}\r\n                    >\r\n                      ({this.state.seatReserved.length})\r\n                    </span>\r\n                    ghế\r\n                    <br />\r\n                    {this.state.seatReserved.map((item) => {\r\n                      return item + \", \";\r\n                    })}\r\n                  </h5>\r\n                  <h5 id=\"tongTien\" style={{ fontWeight: 300 }}>\r\n                    Tổng số tiền là:\r\n                    <span style={{ color: \"red\", fontWeight: \"bold\" }}>\r\n                      (\r\n                      {this.props.dslichchayData.map((item, index) => {\r\n                        if (item.idTuyen === this.step1.idTuyen) {\r\n                          return (\r\n                            parseInt(item.Gia) *\r\n                            parseInt(this.state.seatReserved.length)\r\n                          )\r\n                            .toString()\r\n                            .replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\r\n                        }\r\n                      })}\r\n                      )\r\n                    </span>\r\n                    đ\r\n                  </h5>\r\n                </div>\r\n                <DrawGrid\r\n                  seat={this.state.seat}\r\n                  available={this.state.seatAvailable}\r\n                  reserved={this.state.seatReserved}\r\n                  booked={this.state.seatBooked}\r\n                  onClickData={this.onClickData.bind(this)}\r\n                />\r\n              </div>\r\n            </div>\r\n            {/* end col 8 */}\r\n            <div className=\"col-md-4\">\r\n              <div className=\"card\">\r\n                <div className=\"card-header card-header-primary\">\r\n                  <h4 className=\"card-title\">\r\n                    {this.step1.inputTuyen} <br />\r\n                    {inngaydi}\r\n                  </h4>\r\n                </div>\r\n                <div className=\"card-body\">\r\n                  <form>\r\n                    <div className=\"form-check form-check-radio\">\r\n                      <label className=\"form-check-label\">\r\n                        <input\r\n                          className=\"form-check-input\"\r\n                          type=\"radio\"\r\n                          name=\"exampleRadios\"\r\n                          id=\"exampleRadios2\"\r\n                          defaultValue=\"option2\"\r\n                          defaultChecked\r\n                        />\r\n                        Giá vé:{\" \"}\r\n                        {this.props.dslichchayData.map((item, index) => {\r\n                          if (item.idTuyen === this.step1.idTuyen) {\r\n                            return item.Gia.toString().replace(\r\n                              /\\B(?=(\\d{3})+(?!\\d))/g,\r\n                              \",\"\r\n                            );\r\n                          }\r\n                        })}{\" \"}\r\n                        đ / người\r\n                        <span className=\"circle\">\r\n                          <span className=\"check\" />\r\n                        </span>\r\n                      </label>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                      <h4\r\n                        className=\"info-title\"\r\n                        style={{ marginBottom: \"0px\" }}\r\n                      >\r\n                        Biển số xe\r\n                      </h4>\r\n                      <p>\r\n                        {this.props.dsxeData.map((item) => {\r\n                          if (item.id === this.state.idXe) {\r\n                            return item.BSXe;\r\n                          }\r\n                        })}\r\n                      </p>\r\n                    </div>\r\n\r\n                    <div className=\"form-group\">\r\n                      <h4\r\n                        className=\"info-title\"\r\n                        style={{ marginBottom: \"0px\" }}\r\n                      >\r\n                        Giờ khởi hành\r\n                      </h4>\r\n                      <select\r\n                        className=\"form-control\"\r\n                        id=\"exampleFormControlSelect1\"\r\n                        name=\"GioKhoiHanh\"\r\n                      >\r\n                        <option value=\"06:00\">06:00</option>\r\n                        <option value=\"09:00\">09:00</option>\r\n                        <option value=\"12:00\">12:00</option>\r\n                        <option value=\"18:00\">18:00</option>\r\n                      </select>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                      <h4\r\n                        className=\"info-title\"\r\n                        style={{ marginBottom: \"0px\" }}\r\n                      >\r\n                        Điểm lên xe\r\n                      </h4>\r\n                      <select\r\n                        className=\"form-control\"\r\n                        id=\"exampleFormControlSelect2\"\r\n                      >\r\n                        <option>475A Điện Biên Phủ</option>\r\n                        <option>Khu Công Nghệ Cao</option>\r\n                        <option>Ung Văn Khiêm</option>\r\n                      </select>\r\n                    </div>\r\n                    <div className=\"info pt-1\">\r\n                      <h4 className=\"info-title\">Miễn phí</h4>\r\n                      <div className=\"icon icon-info\">\r\n                        <div className=\"icon icon-primary\">\r\n                          <i className=\"material-icons\">wifi</i>\r\n                          <i className=\"material-icons\">fastfood</i>\r\n                          <i className=\"material-icons\">music_video</i>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                    <button\r\n                      type=\"submit\"\r\n                      className=\"btn btn-block btn-success\"\r\n                      onClick={(e) => this.handleSubmit(e)}\r\n                    >\r\n                      Tiếp tục <span className=\"material-icons\">forward</span>\r\n                    </button>\r\n                  </form>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            {/* end col 4 */}\r\n          </div>\r\n          {/* end row */}\r\n        </div>\r\n        {/* end container */}\r\n      </section>\r\n    );\r\n  }\r\n}\r\n\r\nclass DrawGrid extends React.Component {\r\n  render() {\r\n    var classOfSeat = (col) => {\r\n      if (this.props.reserved.indexOf(col) > -1) {\r\n        return \"reserved\";\r\n      } else if (this.props.booked.indexOf(col) > -1) {\r\n        return \"booked\";\r\n      } else {\r\n        return \"available\";\r\n      }\r\n    };\r\n    return (\r\n      <div className=\"container\">\r\n        <table className=\"table table-striped|table-dark|table-bordered|table-borderless|table-hover|table-sm\">\r\n          <thead\r\n            className=\"thead-dark|thead-light\"\r\n            style={{ padding: \"16px 16px\" }}\r\n          >\r\n            <tr>\r\n              <th scope=\"col\" style={{ color: \"#ff9e00\" }}>\r\n                Sơ đồ ghế\r\n              </th>\r\n              <th scope=\"col\">\r\n                <div style={{ color: \"#eaeaea\" }}>\r\n                  <span className=\"material-icons\">\r\n                    airline_seat_recline_extra\r\n                  </span>\r\n                  <br /> đã đặt\r\n                </div>\r\n              </th>\r\n              <th scope=\"col\">\r\n                <div style={{ color: \"#ff9e00\" }}>\r\n                  <span className=\"material-icons\">\r\n                    airline_seat_recline_extra\r\n                  </span>\r\n                  <br /> đang chọn\r\n                </div>\r\n              </th>\r\n              <th scope=\"col\">\r\n                <div style={{ color: \"#202429\" }}>\r\n                  <span className=\"material-icons\">\r\n                    airline_seat_recline_extra\r\n                  </span>\r\n                  <br /> còn trống\r\n                </div>\r\n              </th>\r\n            </tr>\r\n          </thead>\r\n          {/* end table header */}\r\n          <tbody>\r\n            <tr>\r\n              <td>\r\n                <img\r\n                  style={{ width: \"50px\", height: \"50px\" }}\r\n                  src=\"assets/img/volang.png\"\r\n                  alt=\"Tài xế\"\r\n                />{\" \"}\r\n                <h4 className=\"card-title\">Lái xe</h4>\r\n              </td>\r\n              <td></td>\r\n              <td></td>\r\n              <td>\r\n                <img\r\n                  style={{ width: \"50px\", height: \"50px\" }}\r\n                  src=\"assets/img/cua.png\"\r\n                  alt=\"Cửa lên xuống\"\r\n                />\r\n                <h4 className=\"card-title\">Cửa lên</h4>\r\n              </td>\r\n            </tr>\r\n            {this.props.seat.map((row) => (\r\n              <tr key={row}>\r\n                {row.map((col) => (\r\n                  <td\r\n                    className={classOfSeat(col)}\r\n                    key={col}\r\n                    onClick={(e) => this.onClickSeat(col)}\r\n                  >\r\n                    <span className=\"material-icons\">\r\n                      airline_seat_recline_extra\r\n                    </span>\r\n                    <br />\r\n                    {col}{\" \"}\r\n                  </td>\r\n                ))}\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n\r\n        {/* <AvailableList available={this.props.available} /> */}\r\n        {/* <ReservedList reserved={this.props.reserved} /> */}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  onClickSeat(seat) {\r\n    this.props.onClickData(seat);\r\n  }\r\n}\r\n\r\n// class AvailableList extends React.Component {\r\n//   render() {\r\n//     const seatCount = this.props.available.length;\r\n//     return (\r\n//       <div className=\"text-center\">\r\n//         <h4>\r\n//           Ghế còn trống: ({seatCount === 0 ? \"No seats available\" : seatCount})\r\n//         </h4>\r\n//         <span>\r\n//           {this.props.available.map((res) => (\r\n//             <p key={res}>{res} - </p>\r\n//           ))}\r\n//         </span>\r\n//       </div>\r\n//     );\r\n//   }\r\n// }\r\n\r\n// class ReservedList extends React.Component {\r\n//   render() {\r\n//     return (\r\n//       <div className=\"right\">\r\n//         <h4>Ghế đang chọn: ({this.props.reserved.length})</h4>\r\n//         <ul>\r\n//           {this.props.reserved.map((res) => (\r\n//             <li key={res}>{res}</li>\r\n//           ))}\r\n//         </ul>\r\n//       </div>\r\n//     );\r\n//   }\r\n// }\r\n\r\nconst mapStateToProps = (state, ownProps) => {\r\n  return {\r\n    dslichchayData: state.dslichchayReducer.dslichchayData,\r\n    dsxeData: state.dsxeReducer.dsxeData,\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps)(ChonGhe);\r\n"]},"metadata":{},"sourceType":"module"}